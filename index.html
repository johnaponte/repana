<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="Set of utilities to facilitate the reproduction of analysis in R.
 It allow to make_structure(), clean_structure(), and run and log programs in a
 predefined order to allow secondary files, analysis and reports be constructed in
 an ordered and reproducible form.">
<title>Repeatable Analysis in R • repana</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Repeatable Analysis in R">
<meta property="og:description" content="Set of utilities to facilitate the reproduction of analysis in R.
 It allow to make_structure(), clean_structure(), and run and log programs in a
 predefined order to allow secondary files, analysis and reports be constructed in
 an ordered and reproducible form.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">repana</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.23.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/using_repana.html">Using repana</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/johnaponte/repana/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>There are several utilities in the R ecosystem for reproducible research. The package repana (for Reproducible Analysis) help in having a common directory structure where to save the files that should be consider part of the main stream of production, and files that are products of the main stream as well as modified files no longer part of the main stream but need to be kept such as re-formatted reports or presentations.</p>
<p>The aspiration of this package is that you can set up an analysis with the <code><a href="reference/make_structure.html">make_structure()</a></code> function, have access to the database using <code><a href="reference/get_con.html">get_con()</a></code> function, have your tables in the database documented with the <code><a href="reference/update_table.html">update_table()</a></code> function, and reproduce a complete analysis by running the <code><a href="reference/master.html">master()</a></code> function</p>
</div>
<div class="section level2">
<h2 id="directory-structure">Directory Structure<a class="anchor" aria-label="anchor" href="#directory-structure"></a>
</h2>
<p>The function <code><a href="reference/make_structure.html">make_structure()</a></code> reads the <code>config.yml</code> files and ensure all entries on the <code>dirs</code> section exists. The <code>config.yml</code> created by default will produce the following directories for the data, functions, database, logs, reports and handmade entries of the <code>config.yml</code>:</p>
<ul>
<li><p>_<strong>data</strong> to keep all data sources need to reproduce the analysis.</p></li>
<li><p>_<strong>functions</strong> to keep all functions programmed for the analysis</p></li>
<li><p><strong>database</strong> to keep all secondary datasets and objects</p></li>
<li><p><strong>logs</strong> to keep the log of the scripts</p></li>
<li><p><strong>reports</strong> to keep all secondary analysis reports and sheets</p></li>
<li><p><strong>handmade</strong> to keep all modified files and reports that should be kept</p></li>
</ul>
<p>The directories can be used in your programs by the <code><a href="reference/get_dirs.html">get_dirs()</a></code> function.</p>
<p>The information in <code>data</code>, <code>functions</code>, <code>handmade</code> as well as the scripts in the root directory should be preserved as they are the core of your analysis. The files in <code>logs</code>, <code>reports</code> and <code>database</code> are created and recreated as result of your analysis’ scripts. Those are the results of your analysis.</p>
<p>The function <code><a href="reference/clean_structure.html">clean_structure()</a></code>clean those directories included in the list <code>clean_before_new_analysis</code> so a new analysis could be re-run without worries that new and old results are mixed. If you use <code>git</code>, those directories are candidates to be excluded from the control version by having them in the <code>.gitignore</code> file. (<code><a href="reference/make_structure.html">make_structure()</a></code> take care of create a <code>.gitignore</code> if it does not exist or include those directories if they have not been yet included).</p>
<p>The function <code><a href="reference/make_structure.html">make_structure()</a></code> writes a <code>config.yml</code> if it does not exists. This file is used by the <code><a href="https://rstudio.github.io/config/reference/get.html" class="external-link">config::get()</a></code> function. It contains a the following entries under the default: tree</p>
<p><strong>dirs:</strong> to define the directories that make_structure will maintain. It have the entry values for <code>data</code>, <code>functions</code>, <code>database</code>, <code>reports</code>, <code>logs</code>, <code>handmade</code> directories. If you prefer other options than the defaults values you may change it. You may access those directories in your programs using <code><a href="reference/get_dirs.html">get_dirs()</a></code> Note that the name for <code>data</code> and <code>function</code> does not have a underscore but by default the values are <code>_data</code> and <code>_function</code> respectively. <code>make_structure</code> will create the paths with the value of the entries but you access them in your program with the name of the entry. This will provide the freedom to direct the real path of the directory to any place you need.</p>
<p><strong>clean_before_new_analysis:</strong> to define the list of directories that should be cleaned every time you want to repeat the analysis from zero. This directories are included in the <code>.gitignore</code></p>
<p><strong>defaultdb:</strong> is written with the parameters for a <code>RSQLite SQLite</code> driver</p>
<p>You may add other entries that your analysis may requires. The <code>config.yml</code> itself should also be included in your <code>.gitignore</code> file as it is something that change from system to system (i.e. driver parameters) so you should include in the documentation of your analysis what entries should be defined so you can reproduce the analysis in other machine.</p>
</div>
<div class="section level2">
<h2 id="the-configuration-of-database">The configuration of database<a class="anchor" aria-label="anchor" href="#the-configuration-of-database"></a>
</h2>
<p>DBI and Pool connections are used as a way to keep data as well as results in a database system. You must provide, at least, values for the <code>package</code> and <code>dbconnection</code> entries corresponding to the package that host the dbConnection and the name of the dbConnection function. Notice entry names are lowercase. The rest of the entries must correspond for parameters for your driver connection or pool connection.</p>
<p>Example to use <code>RSQLite</code> with a <code>results.db</code> file in the database directory</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">defaultdb</span><span class="kw">:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">package</span><span class="kw">:</span><span class="at"> RSQLite</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dbconnect</span><span class="kw">:</span><span class="at"> SQLite</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dbname</span><span class="kw">:</span><span class="at"> dbname/results.db</span></span></code></pre></div>
<p>Example to use <code>RPostgres</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">defaultdb</span><span class="kw">:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">package</span><span class="kw">:</span><span class="at"> RPostgres</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dbconnection</span><span class="kw">:</span><span class="at"> Postgres</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dbname</span><span class="kw">:</span><span class="at"> testdb</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">host</span><span class="kw">:</span><span class="at"> localhost</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">port</span><span class="kw">:</span><span class="at"> </span><span class="dv">5432</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">user</span><span class="kw">:</span><span class="at"> username</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">password</span><span class="kw">:</span><span class="at"> password</span></span></code></pre></div>
<p>You can define several configuration to use different databases in the same analysis, but the <code>defaultdb</code> will be used by default for the <code><a href="reference/update_table.html">update_table()</a></code> function.</p>
<p>The function <code>update_table</code> will save a data.frame into the database, and will keep a log in the <code>log_table</code> table with the timestamps the file was updated in the database. The <code>log_table</code> keep a record of when was the table included in the database and a comment that will help to trace the origin. You may include the date data was obtained or the source of the data.</p>
<p><code>update_table(p_con,"iris", "from system)</code></p>
</div>
<div class="section level2">
<h2 id="the-master-function">The master function<a class="anchor" aria-label="anchor" href="#the-master-function"></a>
</h2>
<p>The <code>master(pattern, start, stop, logdir, rscript_path)</code> function execute in a plain vanilla R process each one of the files identified by the pattern. By default use the pattern is <code>"^[0-9][0-9].*\\.R$"</code>, which include all files like <code>01_read_data.R</code>, <code>02_process_data.R</code>, <code>03_analysis_data.R</code>, <code>04_make_report.R</code> but not <code>report1.rmd</code>, <code>exploratory.R</code> etc.. Files are run on the order starting from the first but if for any reason you need to omit the first files you may skip them with the <code>start</code> parameter.</p>
<p><code>logdir</code> is the directory for the logs, by default <code>get_dirs()$logs</code></p>
<p><code>rscript_path</code> is the full path to the <code>Rscript</code> program which is at the end the one that process the <code>R</code> file. The current default is for a OS system. But implementation for Linux and Windows will soon be implemented.</p>
<p>The master function use functions from the <code>processx</code> package.</p>
</div>
<div class="section level2">
<h2 id="the-configyml-file">The config.yml file<a class="anchor" aria-label="anchor" href="#the-configyml-file"></a>
</h2>
<p>Here is an example of the <code>config.yml</code> created by <code><a href="reference/make_structure.html">make_structure()</a></code></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode *.yml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">default</span><span class="kw">:</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">dirs</span><span class="kw">:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">data</span><span class="kw">:</span><span class="at"> _data</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">functions</span><span class="kw">:</span><span class="at"> _functions</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">handmade</span><span class="kw">:</span><span class="at"> handmade</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">database</span><span class="kw">:</span><span class="at"> database</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">reports</span><span class="kw">:</span><span class="at"> reports</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">logs</span><span class="kw">:</span><span class="at"> logs</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">clean_before_new_analysis</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> database</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> reports</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="kw">-</span><span class="at"> logs</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">defaultdb</span><span class="kw">:</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">package</span><span class="kw">:</span><span class="at"> RSQLite</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dbconnect</span><span class="kw">:</span><span class="at"> SQLite</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">dbname</span><span class="kw">:</span><span class="at"> </span><span class="st">":memory:"</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">driver</span><span class="kw">:</span><span class="at">  /usr/local/lib/libsqlite3odbc.dylib </span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">database</span><span class="kw">:</span><span class="at"> database/results.db</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-up">Set-up<a class="anchor" aria-label="anchor" href="#set-up"></a>
</h2>
<p>You may download the package from git-hub. Within R you may use <code>devtools::install_github()</code> as:</p>
<p><code>devtools::install_github("johnaponte/repana", build_manual = T, build_vignettes = T)</code></p>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=repana" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/johnaponte/repana/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing repana</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>John J. Aponte <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3014-3673" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by John J. Aponte.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
